Title: CNN for Samsung Edge Panel HTTP usage tampering and monitoring potential
Firmware version: G950FXXU3CRGH, Android 8.0.0, patch level 1. August 2018
App version: 1.0.rc39 (build 39)
Description: Samsung exclusive app CNN for Samsung Edge Panel uses HTTP to get sections, images, headlines. On an insecure or untrusted network it's this possible for a third-party (someone not CNN or the user) to monitor app usage, preferences (sections the user is interested in), content (images and headlines), or modify content (images, headlines, links). The included PoC uses mitmdump and python to monitor telemetry and modify content, replacing headlines, images and links. While the PoC could use HTTP 301 to move the section-definitions to a third-party server, this has intentionally not been done, in order to ensure it's easily reversible.


PoC
See included .zip, folder src
requirements: mitmproxy 4.0.4 installed on the PC, CNN for Samsung Edge Panel installed on the Samsung mobile device (available in the Galaxy Store)
Only tested with python 3.6.5 on Ubuntu 18.04.1

1. On the test PC run: mitmdump -s ./src/demo.py --anticomp --anticache --ignore :443$
2. On the Samsung mobile device: set the test PC as the HTTP proxy of the device
3. (not necessary) On the Samsung mobile device: open a browser and go to a website, if you see "... clientconnect" or "GET ..." in the window mitmdump terminal, things should be working
4. Open the CNN for Samsung Edge Panel app, if the PoC works, you should see all categories being called "Hacking", and all the news being replaced with jokes. Pressing "Hack all the things", should then open a YouTube video. Additionally, the terminal should have at least one line reading "Got metrics ...", config.outturner.com, metrics.cnn.com and compositor.api.cnn.com.

Depending on caching, you might experience that the sections retain their unmodified names, if this happens but the headlines and such changed the app didn't reload edge-config.json but did reload the sections. If the headlines and such didn't change, something went wrong, look for the URLs listed in url-list.txt, if these don't appear, try to manually refresh the app or wait 5~10 minutes and try step 4 again.



Expected behavior
1. HTTPS support, HTTP 301, HSTS on compositor.api.cnn.com
2. App fetches edge-config.json
3. edge-config.json only lists https URLs
4. edgepanelkill.json only lists https URLs
5. App only uses HTTPS for metrics

Anticipated changes
CNN patching their app and API to only use HTTPS by replacing the schema in URLs.

Disclosure plans
The current plan is to disclose at a point after a patch is released, any more detailed plans do not exist

Supporting material
In included .zip:
2018_09_07_02_24_40.mp4 - screen-recording of an earlier PoC
src/ - source-code for the PoC
description.txt - Copy of bug-report
url-list.txt - Vulnerable URL prefixes found to be in use, LF file-endings